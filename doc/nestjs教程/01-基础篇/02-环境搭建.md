# 环境搭建

在开始学习 NestJS 之前，我们需要搭建好开发环境。本章节将指导你安装和配置 NestJS 开发所需的所有工具和依赖。

## 1. 安装 Node.js

NestJS 是基于 Node.js 构建的，因此首先需要安装 Node.js。建议安装 Node.js v20 或更高版本，因为 NestJS v11.x 推荐使用 Node.js v20+。

### 1.1 下载 Node.js

访问 [Node.js 官方网站](https://nodejs.org/) 下载适合你操作系统的 Node.js 安装包。

- **Windows**: 下载 `.msi` 安装包，双击运行并按照向导进行安装。
- **macOS**: 下载 `.pkg` 安装包，双击运行并按照向导进行安装；或者使用 Homebrew 安装：`brew install node`。
- **Linux**: 使用包管理器安装，如 Ubuntu 可使用 `sudo apt install nodejs npm`。

### 1.2 验证 Node.js 安装

安装完成后，打开命令行终端，运行以下命令验证 Node.js 和 npm（Node.js 包管理器）是否安装成功：

```bash
# 查看 Node.js 版本
node -v

# 查看 npm 版本
npm -v
```

如果你看到类似以下的输出，说明 Node.js 和 npm 安装成功：

```
v20.17.0  # Node.js 版本
10.8.3    # npm 版本
```

## 2. 安装包管理器

除了 npm，你还可以选择使用其他包管理器，如 yarn 或 pnpm，它们提供了更快的安装速度和更好的依赖管理。

### 2.1 安装 Yarn

Yarn 是 Facebook 开发的包管理器，具有更快的安装速度和更可靠的依赖管理。

```bash
# 使用 npm 安装 Yarn
npm install -g yarn

# 验证 Yarn 安装
```bash
# 查看 Yarn 版本
yarn -v
```

### 2.2 安装 pnpm

pnpm 是一个快速、节省磁盘空间的包管理器，使用符号链接来共享依赖。

```bash
# 使用 npm 安装 pnpm
npm install -g pnpm

# 验证 pnpm 安装
# 查看 pnpm 版本
pnpm -v
```

## 3. 安装 Nest CLI

Nest CLI 是 NestJS 官方提供的命令行工具，可以帮助我们快速创建项目、生成组件、运行测试等。

### 3.1 安装 Nest CLI

使用以下命令全局安装 Nest CLI：

```bash
# 使用 npm 安装
npm install -g @nestjs/cli

# 使用 Yarn 安装
yarn global add @nestjs/cli

# 使用 pnpm 安装
pnpm add -g @nestjs/cli
```

### 3.2 验证 Nest CLI 安装

安装完成后，运行以下命令验证 Nest CLI 是否安装成功：

```bash
# 查看 Nest CLI 版本
nest --version
```

如果你看到类似以下的输出，说明 Nest CLI 安装成功：

```
11.0.0  # Nest CLI 版本
```

## 4. 安装代码编辑器

虽然你可以使用任何文本编辑器来编写 NestJS 代码，但推荐使用以下代码编辑器，它们提供了更好的 TypeScript 和 NestJS 支持：

### 4.1 Visual Studio Code (VS Code)

VS Code 是微软开发的免费开源代码编辑器，提供了强大的 TypeScript 支持、智能提示、调试功能等。

- [下载 VS Code](https://code.visualstudio.com/)

### 4.2 推荐扩展

安装 VS Code 后，建议安装以下扩展来提升 NestJS 开发体验：

1. **TypeScript Hero**: 提供 TypeScript 代码自动补全、导入管理等功能。
2. **NestJS Snippets**: 提供 NestJS 代码片段，快速生成控制器、服务、模块等代码。
3. **ESLint**: 代码质量检查工具，帮助你遵循代码规范。
4. **Prettier**: 代码格式化工具，保持代码风格一致。
5. **REST Client**: 可以直接在 VS Code 中发送 HTTP 请求，测试 API。
6. **Docker**: Docker 支持，方便部署和运行应用。

## 5. 配置 Git

Git 是一个分布式版本控制系统，用于跟踪代码变化。建议在开始开发前安装和配置 Git。

### 5.1 安装 Git

- **Windows**: 下载 [Git for Windows](https://gitforwindows.org/) 并安装。
- **macOS**: 使用 Homebrew 安装：`brew install git`。
- **Linux**: 使用包管理器安装，如 Ubuntu 可使用 `sudo apt install git`。

### 5.2 配置 Git

安装完成后，配置 Git 的用户名和邮箱：

```bash
# 配置用户名
git config --global user.name "你的用户名"

# 配置邮箱
git config --global user.email "你的邮箱"
```

## 6. 验证开发环境

现在我们已经安装了所有必要的工具，让我们验证一下开发环境是否配置正确：

```bash
# 验证 Node.js 版本
node -v

# 验证 npm 版本
npm -v

# 验证 Nest CLI 版本
nest --version

# 验证 Git 版本
git --version
```

如果所有命令都能正常执行并显示版本信息，说明你的开发环境已经配置成功。

## 7. 常见问题解决

### 7.1 权限问题

在安装全局包时，可能会遇到权限问题。可以尝试以下解决方法：

- **Windows**: 以管理员身份运行命令行终端。
- **macOS/Linux**: 在命令前添加 `sudo`，如 `sudo npm install -g @nestjs/cli`。

### 7.2 网络问题

如果在安装包时遇到网络问题，可以尝试以下解决方法：

- 切换到国内镜像源，如 npm 可以使用淘宝镜像：`npm config set registry https://registry.npmmirror.com`
- 检查网络连接，确保可以访问互联网
- 尝试使用其他包管理器，如 yarn 或 pnpm

### 7.3 版本不兼容问题

如果遇到版本不兼容问题，建议：

- 确保 Node.js 版本符合要求（v20+）
- 确保 Nest CLI 版本与 NestJS 版本兼容
- 查看官方文档或 GitHub issues 寻找解决方案

## 8. 小结

在本章节中，我们学习了如何搭建 NestJS 开发环境，包括：

- 安装 Node.js v20+ 
- 安装包管理器（npm/yarn/pnpm）
- 安装 Nest CLI
- 安装和配置代码编辑器（VS Code）
- 配置 Git

现在，我们已经准备好开始创建第一个 NestJS 应用了。在下一章节中，我们将学习如何使用 Nest CLI 创建和运行 NestJS 应用。
